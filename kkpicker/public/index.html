<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>KKPicker</title>
    <!-- Vue Js -->
    <script src="vue.js"></script>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy"
        crossorigin="anonymous">
    <link rel="stylesheet" href="main.css">
    <!-- Firebase Scripts-->
    <script defer src="/__/firebase/4.6.2/firebase-app.js"></script>
    <script defer src="/__/firebase/4.6.2/firebase-auth.js"></script>
    <!-- <script defer src="/__/firebase/4.6.2/firebase-database.js"></script> -->
    <script defer src="/__/firebase/4.6.2/firebase-firestore.js"></script>
    <script defer src="/__/firebase/init.js"></script>
    <!--Auth UI -->
    <script src="https://cdn.firebase.com/libs/firebaseui/2.4.1/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.4.1/firebaseui.css" />
    <!-- Google Icon Fonts -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Google Material Components--><link
      rel="stylesheet"
      href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
</head>

<body>

    <div id="app">
        <nav class="navbar navbar-expand-md navbar-dark bg-dark">
            <span class="mr-auto my-2">
                <a class="navbar-brand" href="#">KKPICKER</a>
            </span>
            <!-- Logged ON Nav -->
            <template v-if="loggedIn">
                <span class="row mx-4">
                    <ul class="navbar-nav my-2 my-lg-0">
                        <li class="nav-item">
                            <a id="profile" class="nav-link" data-toggle="modal" data-target="#profileModal" href="#">Profile</a>
                        </li>
                        <li class="nav-item">
                            <a v-on:click="signOut" id="logout" class="nav-link" href="#">Logout</a>
                        </li>
                    </ul>
                </span>
            </template>
            <!-- Logged OFF Nav -->
            <template v-else>
                <span class="row mx-4">
                    <ul class="navbar-nav my-2 my-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" id="login" v-on:click="openSignIn">Sign In</a>
                        </li>
                    </ul>
                </span>
            </template>
        </nav>
        <div class="container">
            <template v-if="loggedIn">
                <div class="row justify-content-center my-4 loggedOn">
                    <template v-if="group_ready" v-for="(group, grpIndex) in groups">
                        <div class="card" style="width: 70rem; margin:10px">
                            <div class="card-body">
                                <div class="row align-items-center slide">
                                    <span class="col">
                                        <h4 v-on:click="showGroup(group.id,!group.grpshow)" class="card-title accordion noselect">{{group.data.Name}}
                                        </h4>
                                    </span>
                                    <span class="col mr-auto">
                                        <div class="row justify-content-end pr-2">
                                            <i class="material-icons noselect pointer" v-on:click="moveGroupUp(group.id)">arrow_drop_up</i>
                                        </div>
                                        <div class="row justify-content-end pr-2">
                                            <i class="material-icons noselect pointer" v-on:click="moveGroupDown(group.id)">arrow_drop_down</i>
                                        </div>
                                    </span>
                                </div>
                                <transition name="fade">
                                    <div v-if="group.grpshow">
                                        <p class="card-text">
                                            <div class="row align-items-center">
                                                <span class="col">
                                                    <h5 class="card-subtitle text-center pb-2">Members</h5>
                                                    <ul class="list-group">
                                                        <li class="list-group-item bg-secondary">
                                                            <div class="row align-items-center">
                                                                <span class="col">
                                                                    Name
                                                                </span>
                                                                <span v-if="group.data.assign == true" class="col">
                                                                    Partner
                                                                </span>
                                                                <span class="col"></span>
                                                            </div>
                                                        </li>
                                                        <li v-for="member in group.members" class="list-group-item ">
                                                            <div class="row align-items-center">
                                                                <span class="col">
                                                                    {{member.name}}
                                                                </span>
                                                                <span v-if="group.data.assign == true" class="col">
                                                                    {{member.pname}}
                                                                </span>
                                                                <span class="col">
                                                                    <div class="row justify-content-end">
                                                                        <button v-if="group.data.Administrator == user.uid" class="btn btn-danger" type="button" v-on:click="delMember(group.id,member.uid)">Delete</button>
                                                                    </div>
                                                                </span>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                    <template v-if="group.data.Administrator == user.uid">
                                                        
                                                            <div class="form-group">
                                                                <h5 class="text-center m-2">Administrator Options:</h5>
                                                                <div class="input-group m-2">
                                                                    <div class="input-group-prepend">
                                                                        <span class="input-group-text" id="basic-addon1">Add Group Member</span>
                                                                    </div>
                                                                    <input v-model="newMemberEmail" type="email" class="form-control" id="profileName" aria-describedby="emailHelp" placeholder="Member's Email Address">
                                                                    <div class="input-group-append">
                                                                        <button type="button" class="input-group-text btn btn-success" v-on:click="addMember(groups[grpIndex].id)">Add</button>
                                                                        <loader></loader>
                                                                    </div>
                                                                </div>
                                                                <div class="input-group m-2">
                                                                    <div class="input-group-prepend">
                                                                        <span class="input-group-text" id="basic-addon1">Match Kris Kringles</span>
                                                                    </div>
                                                                    <button type="button" class="input-group-text btn btn-success" v-on:click="match(groups[grpIndex].id)">Match</button>
                                                                    <button type="button" class="input-group-text btn btn-warning" v-on:click="unmatch(groups[grpIndex].id)">Un-Match</button>
                                                                </div>
                                                                <div class="input-group m-2">
                                                                    <div class="input-group-prepend">
                                                                        <span class="input-group-text" id="basic-addon1">Delete Group</span>
                                                                    </div>
                                                                    <button type="button" class="input-group-text btn btn-danger" v-on:click="delGroup(groups[grpIndex].id)">Delete</button>
                                                                </div>
                                                            </div>
                                                    </template>
                                                </span>
                                            </div>
                                        </p>
                                    </div>
                                </transition>
                            </div>
                        </div>
                    </template>
                </div>
                <div id="addBtnArea">
                </div>
                 <button id="addBtn" class="material-icons" data-toggle="modal" data-target="#addModal" >add</button> 
            
            </template>

            <template v-else>
                <div class="row justify-content-center my-4 loggedOff">
                    Please Sign In to Use this App
                </div>
            </template>
        </div>

        <!-- Add Group Modal -->
        <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addModalLabel">New Group</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="groupNamelbl">Group Name</label>
                                <input v-model="newGroup.name" type="text" class="form-control" id="groupName" aria-describedby="emailHelp" placeholder="Name your Group">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" v-on:click="createGroup">Save</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </div>
                </div>
            </div>
        </div>

        <!-- Profile Modal-->
        <div class="modal fade" id="profileModal" tabindex="-1" role="dialog" aria-labelledby="profileModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addModalLabel">Profile</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="formNamelbl">Profile Name:</label>
                                <input v-model="profile.name" type="text" class="form-control" id="profileName" aria-describedby="emailHelp" placeholder="Your Name">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" v-on:click="saveProfile">Save</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sign In Modal -->
    <div class="modal fade" id="SignInModal" tabindex="-1" role="dialog" aria-labelledby="SignInModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="SignInModalLabel">Sign In</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body ">
                    <div id="firebaseui-auth-container"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</body>
<!-- Bootstrap JavaScript Dependancies -->
<script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js " integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN "
    crossorigin="anonymous "></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js " integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh "
    crossorigin="anonymous "></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js " integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ "
    crossorigin="anonymous "></script>
    
<script src="app.js" type="text/javascript"></script>

</html>