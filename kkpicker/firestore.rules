service cloud.firestore {
  match /databases/{database}/documents {
  		
	    match /users/{user} {
      	allow read, write : if request.auth.uid == resource.data.userid;
        match /groups/{group}{
        	allow read,write : if request.auth.uid == get(/databases/$(database)/documents/users/$(user)).data.userid;
        }
    }
    
  	match /Group/{group} {
      allow read: if exists(/databases/$(database)/documents/Group/$(group)/Members/$(request.auth.uid));
      allow write: if request.auth.uid == get(/databases/$(database)/documents/Group/$(group)).data.Administrator;
      match /Members/{member}{
            allow read: if exists(/databases/$(database)/documents/Group/$(group)/Members/$(request.auth.uid));
            allow write: if request.auth.uid == get(/databases/$(database)/documents/Group/$(group)).data.Administrator;
      }
      match /Administrators/{doc=**}{
            allow read: if exists(/databases/$(database)/documents/Group/$(group)/Members/$(request.auth.uid));
            allow write: if request.auth.uid == get(/databases/$(database)/documents/Group/$(group)).data.Administrator;
      }
			match /email_addr/{doc=**}{
            allow read: if exists(/databases/$(database)/documents/Group/$(group)/Members/$(request.auth.uid));
            allow write: if request.auth.uid == get(/databases/$(database)/documents/Group/$(group)).data.Administrator;
      }
      }
  
}
}
